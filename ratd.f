      PROGRAM RATD
C...RAPID AXIAL TURBINE DESIGN PROGRAM. WRITTEN JANUARY OF 1984 BY LJP
C...INPUT FILE = 25, OUTPUT FILE = 16. SOME DEBUG WRITES COMMENTED OUT.
!
!   VER. 2022
!   VERSION OF 2022 BY MSN
!   SOURCE FROM PDF FILE, ARTICLE CODE IS 85-GT-219
!   IN THIS VERSION NOT USED OUTPUT TO CALCOMP PLOTTER.
!   https://people.sc.fsu.edu/~jburkardt/f77_src/calcomp/calcomp.html
!   SOME CALCOMP PLOTTER RELATED CODE HAS BEEN COMMENTED OUT.
!
!     DIMENSION XS(52),YS(52),XP(52),YP(52),TITLE(9),XC(24),YC(24)
!                                           ^ ISSUE: READ(25,8) TITLE
      DIMENSION XS(52),YS(52),XP(52),YP(52),XC(24),YC(24)
!
      REAL NB
      LOGICAL ITER  ! USED FOR TMAX/CHORD*1OO ITERATION
      ICG=0
      PI=3.14159
!
!   VER. 2022
!   HARDCODED NAMES OF INPUT, OUTPUT FILES
      OPEN(25, FILE = './input.txt', ACTION = 'READ')
      OPEN(16, FILE = './output.txt', ACTION = 'WRITE')
!
!   VER. 2022
!   COMMENTED OUT: ITIALISE AND OUTPUT TO CALCOMP PLOTTER
!     CALL PLOTS(0.,0.,-20)
!     CALL PLOT(0.,-15.,-3)
!     CALL PLOT(1.,2.5,-31)
!
!   VER. 2022
!     READ(25,8) TITLE
!   8 FORMAT(9A6)
      READ(25,*) N,NB,FACTOR,ITRIG
      DO 1 II=1,N
      ITER=.FALSE.
      READ(25,*) R,CX,CT,THROAT,UGT,BIN,WEDGIN,RLE,BOUT,RTE
C...DEFAULT VALUES
      IF(RLE>=2.0) RLE=RLE/100.*2.*PI*R/NB*COS(BIN*PI/180.)/2.
      IF(RTE>=2.0) RTE=RTE/100.*2.*PI*R/NB*COS(BOUT*PI/180.)/2.
!   CX - Axial chord (If CX = 0.0, greek_fi_z is set to 0.8)
      IF(CX<=0.) CX=4.*PI*R/.8/NB*SIN((BIN-BOUT)*PI/180.)
     +*COS(BOUT*PI/180.)/COS(BIN*PI/180.)
      IF(THROAT<=0.) THROAT=2.*PI*R/NB*COS(BOUT*PI/180.)-2.*RTE
      IF(UGT<=0.) UGT=.0001
      WEDGOUT=UGT/2.
      IF(CT<20.) GO TO 30
      CT=CX*TAN(CT*PI/180.)
      GO TO 27
C...IF CT IS BETWEEN 4.0 AND 20.0, THICKNESS/CHORD*100 IS ITERATED UPON
   30 IF(CT>=4.) ITER=.TRUE.
      IF(CT>=4.) TTC=CT/100.
      IF(CT>=4.) CT=0.
C...HERE THE KEY POINTS OF INTEREST ALONG THE BLADE ARE COMPUTED
!
!   POINT NO.1 - SUCTION SURFACE TRAILING EDGE TANGENCY POINT
   27 BETA1=BOUT-WEDGOUT
      X1=CX-RTE*(1.+SIN(BETA1*PI/180.))
      Y1=RTE*COS(BETA1*PI/180.)
!
!   POINT NO.2 - SUCTION SURFACE THROAT POINT
      BETA2=BOUT-WEDGOUT+UGT
      X2=CX-RTE+(THROAT+RTE)*SIN(BETA2*PI/180.)
      Y2=2.*PI*R/NB-(THROAT+RTE)*COS(BETA2*PI/180.)
!
!   POINT NO.3 - SUCTION SURFACE LEADING EDGE TANGENCY POINT
      BETA3=BIN+WEDGIN
      IF(CT==0.) CT=Y2+180./PI*(X2-X3)/(BETA2-BETA3)*ALOG
     +(COS(BETA2*PI/180.)/COS(BETA3*PI/180.))-RLE*COS(BETA3*PI/180.)
      X3=RLE*(1.-SIN(BETA3*PI/180.))
   20 Y3=CT+RLE*COS(BETA3*PI/180.)
!
!   POINT NO.4 - PRESSURE SURFACE LEADING EDGE TANGENCY POINT
      BETA4=BIN-WEDGIN
      X4=RLE*(SIN(BETA4*PI/180.)+1.)
      Y4=CT-RLE*COS(BETA4*PI/180.)
!
!   POINT NO.5 - PRESSURE SURFACE TRAILING EDGE TANGENCY POINT
      BETA5=BOUT+WEDGOUT
      X5=CX-RTE*(1.-SIN(BETA5*PI/180.))
      Y5=-RTE*COS(BETA5*PI/180.)
!
!   POINT NO.6 - RIGHT END POINT
      X6=CX
      Y6=0.
!
!   POINT NO.7 - CENTRE OF TRAILING EDGE CIRCLE
      X7=CX-RTE
      Y7=0.
!
!   POINT NO.8 - LEFT BEGIN POINT
      X8=0.
      Y8=CT
!
!   POINT NO.9 - CENTRE OF LEADING EDGE CIRCLE
      X9=RLE
      Y9=CT
!
      AREA=0.
    2 FORMAT(F20.10)
C...THE CALCULATION OF THE UNCOVERED TURN CIRCLE
      X0=((Y1-Y2)*TAN(BETA1*PI/180.)*TAN(BETA2*PI/180.)
     ++X1*TAN(BETA2*PI/180.)-X2*TAN(BETA1*PI/180.))/(TAN(BETA2*PI/180.)
     +-TAN(BETA1*PI/180.))
      Y0=-(X0-X1)/TAN(BETA1*PI/180.)+Y1
      R0=SQRT((X1-X0)**2+(Y1-Y0)**2)
C...HERE THE EXIT WEDGE ANGLE IS ITERATED UPON TO REMOVE THROAT DISCONTINUITY
      YY2=Y0+SQRT(R0*R0-(X2-X0)**2)
C     WRITE(16,21) WEDGOUT,X2,Y2,YY2
!     WRITE(16,21) WEDGOUT,X2,Y2,YY2
      IF(ABS(Y2-YY2)<.00001) GO TO 26    ! THROAT DISCONTINUITY REMOVED
      WEDGOUT=WEDGOUT*(Y2/YY2)**4
      IF(WEDGOUT>.001) GO TO 27          ! IF WEDGOUT<0 GO TO NEXT SECTION
      WRITE(16,28)
!  28 FORMAT("0THE EXIT WEDGE ANGLE ITERATION FAILED.",/,
   28 FORMAT("THE EXIT WEDGE ANGLE ITERATION FAILED.",/,
     +"THE EXIT WEDGE ANGLE WANTS TO GO NEGATIVE.",/,
     +"REDUCE THE EXIT BLADE ANGLE OR DECREASE THE THROAT.")
      GO TO 1
!   END PAGE 8 OF PDF FILE, ARTICLE CODE IS 85-GT-219
C...THE THIRD ORDER POLYNOMIAL CALL FOR SUCTION AND PRESSURE SURFACE
   26 CALL CUBIC(X2,Y2,BETA2,X3,Y3,BETA3,AS,BS,CS,DS)
      CALL CUBIC(X4,Y4,BETA4,X5,Y5,BETA5,AP,BP,CP,DP)
!   3 FORMAT("1")
C...THTS IS THE SUCTION AND PRESSURE SURFACE DEFINITION / 50 POINTS PER SIDE
!
!   POINT NO.8 - LEFT BEGIN POINT
      XS(1)=X8
      YS(1)=Y8
      XP(1)=X8
      YP(1)=Y8
      DXP=(X4-X8)/9.
      DXS=(X3-X8)/9.
      DO 4 I=2,10
      XP(I)=XP(I-1)+DXP
      YP(I)=Y9-SQRT(RLE*RLE-(XP(I)-X9)**2)
      XS(I)=XS(I-1)+DXS
      YS(I)=Y9+SQRT(RLE*RLE-(XS(I)-X9)**2)
    4 CONTINUE
      DXP=(X5-X4)/30.
      DXS=(X2-X3)/20.
      DO 5 I=11,30
      XP(I)=XP(I-1)+DXP
      YP(I)=AP+XP(I)*(BP+XP(I)*(CP+XP(I)*DP))
      XS(I)=XS(I-1)+DXS
      YS(I)=AS+XS(I)*(BS+XS(I)*(CS+XS(I)*DS))
    5 CONTINUE
      DXS=(X1-X2)/10.
      DO 6 I=31,40
      XP(I)=XP(I-1)+DXP
      YP(I)=AP+XP(I)*(BP+XP(I)*(CP+XP(I)*DP))
      XS(I)=XS(I-1)+DXS
      YS(I)=Y0+SQRT(R0*R0-(XS(I)-X0)**2)
    6 CONTINUE
      DXP=(X6-X5)/10.
      DXS=(X6-X1)/10.
!
!   VER. 2022
!     DO 7 I=41,50 ! FIXED ISSUE NOT-A-NUMBER DURING CALCULATION OF YP(50),
      DO 7 I=41,49
      XP(I)=XP(I-1)+DXP
!     IF(XP(I)>CX) XP(I)=CX  ! VER. 2022: NO NEED, XP(50)=XS(50)=X6=CX
      YP(I)=Y7-SQRT(RTE*RTE-(XP(I)-X7)**2)  ! YP(50) SOMETIMES NOT-A-NUMBER
      XS(I)=XS(I-1)+DXS
!     IF(XS(I)>CX) XS(I)=CX  ! VER. 2022: NO NEED, XP(50)=XS(50)=X6=CX
      YS(I)=Y7+SQRT(RTE*RTE-(XS(I)-X7)**2)  ! YS(50) SOMETIMES NOT-A-NUMBER
    7 CONTINUE
!   VER. 2022
!   FIXED ISSUE NAN(NOT-A-NUMBER) DURING CALCULATION OF YP(50)
!   POINT NO.6 - RIGHT END POINT
      XP(50)=X6
      YP(50)=Y6
      XS(50)=X6
      YS(50)=Y6
!
C...THE CALL TO THE MECHANICAL PROPERTIES SUBROUTINE
      CALL MECPRO(XS,YS,XP,YP,AREA,XCG,YCG)
!      WRITE(16,23) AREA,XCG,YCG
!   23 FORMAT("AREA, XCG, YCG=",3F10.5)
C      WRITE(16,23) AREA,XCG,YCG
C   23 FORMAT("0AREA, XCG, YCG=",3F10.5)
C...THE AIRFOIL MAXIMUH THICKNESS IS FOUND HERE
      TMAX=0.
      DO 17 I=1,50
      TM=999.
      DO 18 J=1,50
      TH=AMIN1(TM,SQRT((XS(I)-XP(J))**2+(YS(I)-YP(J))**2))
   18 CONTINUE
      THAX=AMAX1(TMAX,TM)
   17 CONTINUE
      CHORD=SQRT(CT*CT+CX*CX)
C...MAX THICKNESS-TO-CHORD CONVERGENCE CRITERIA
      IF(.NOT.ITER) GO TO 19
      WRITE(16,21) CT,TMAX,CHORD,TTC
   21 FORMAT(" ",4F10.4)
      IF(ABS(TMAX/CHORD-TTC)<.0001) GO TO 19
C...UPDATED TANGENTIAL CHORD ESTIMATE FOR T/C ITERATION
      CT=CT*(3.*TMAX/CHORD/TTC)/4.
      GO TO 20
C...AIRFOIL PLOTTING CODE
C TODO: ITS OUTPUT TO CALCOMP PLOTTER
   19 XS(51)=0.
      YS(51)=0.
      XS(52)=1./FACTOR
      YSl521=1./FACTOR
      XP(51)=0.
      YP(51)=0.
      XP(52)=1./FACTOR
      YP(52)=1./FACTOR
!
!   VER. 2022
!   COMMENTED OUT: OUTPUT TO CALCOMP PLOTTER
!     IF(ITRIG.NE.4) CALL LINE(XS,YS,50,1,0,4)
!     IF(ITRIG.NE.4) CALL LINE(XP,YP,50,1,0,4)
!
C...THE OUTPUT FILE IS CREATED HERE
      WRITE(16,11)
!  11 FORMAT("1WILLIAMS INTERNATIONAL AXIAL TURBINE GEOMETRY MODEL",/,
!    +"0
   11 FORMAT("WILLIAMS INTERNATIONAL AXIAL TURBINE GEOMETRY MODEL",/,
     +"RADIUS    CX      CT      UGT     BETAIN  WEDGIN  RLE",
     +"     BETAOUT RTE     THROAT  AREA    CGX     CGY")
      PITCH=2.*PI*R/NB
      STAG=ATAN(CT/CX)*180./PI
      ZWEIFEL=4.*PI*R/CX/NB*SIN((BIN-BOUT)*PI/180.)*COS(BOUT*PI/180.)
     +/COS(BIN*PI/180.)
      SOL=CHORD/PITCH
      PCTI=2.*RLE/COS(BIN*PI/180.)/PITCH*100.
      PCTE=2.*RTE/COS(BOUT*PI/180.)/PITCH*100.
      THETAC=BIN-BOUT
      CL=PITCH/CHORD*(COS(BIN*PI/180.)+COS(BOUT*PI/180.))*
!   END PAGE 9 OF PDF FILE, ARTICLE CODE IS 85-GT-219
     +(TAN(BIN*PI/180.)-TAN(BOUT*PI/180.))
      WRITE(16,15) R,CX,CT,UGT,BIN,WEDGIN,RLE,BOUT,RTE,THROAT,AREA,XCG
     +,YCG
!  15 FORMAT("0",13F8.4)
   15 FORMAT(13F8.4)
      WRITE(16,2) X0,Y0,R0,X1,Y1,BETA1,X2,Y2,BETA2,X3,Y3,BETA3,X4,Y4
     +,BETA4,X5,Y5,BETA5,X6,Y6,X7,Y7,X8,Y8,X9,Y9,AS,BS,CS,DS,AP,BP,CP,DP
!   2 FORMAT(F20.10)
C   31 WRITE(16,2) X0,Y0,R0,X1,Y1,BETA1,X2,Y2,BETA2,X3,Y3,BETA3,X4,Y4
C     +,BETA4,X5,Y5,BETA5,X6,Y6,X7,Y7,X8,Y8,X9,Y9,AS,BS,CS,DS,AP,BP,CP,DP
      WRITE(16,12)
!  12 FORMAT("0NUMBER   SUCTION     PRESSURE",/,
   12 FORMAT("NUMBER    SUCTION        PRESSURE",/,
     +"         X       Y       X       Y")
      DO 13 I=1,50
      WRITE(16,14) I,XS(I),YS(I),XP(I),YP(I)
   13 CONTINUE
   14 FORMAT(" ",I3,4F8.4)
C...CHECK FOR INFLECTION POINT ON PRESSURE SURFACE
      XINFL=-CP/3./DP
      IF(XINFL>X4.AND.XINFL<X5) WRITE(16,29)
!  29 FORMAT("0THERE IS AN INFLECTION POINT IN THE PRESSURE SURFACE.",/,
   29 FORMAT("THERE IS AN INFLECTION POINT IN THE PRESSURE SURFACE.",/,
     +" DECREASE UNGUIDED TURNING OR REDUCE TANGENTIAL CHORD.")
!  16 FORMAT(" ")
C...CHANNEL PLOT
      DO 22 I=10,31
      SLOPE=BS+XS(I)*(2.*CS+3.*DS*XS(I))
      IF(SLOPE/=0.) S=-1./SLOPE
      ALPHA=ATAN(S)
      IF(SLOPE==0.) ALPHA=PI/2.
      XC(I-9)=XS(I)+THROAT*COS(ALPHA)
      YC(I-9)=YS(I)+THROAT*SIN(ALPHA)
      IF(S<=0.) XC(I-9)=XS(I)-THROAT*COS(ALPHA)
      IF(S<=0.) YC(I-9)=YS(I)-THROAT*SIN(ALPHA)
   22 CONTINUE
      XC(23)=0.
      YC(23)=0.
      XC(24)=1./FACTOR
      YC(24)=1./FACTOR
!   VER. 2022
!   COMMENTED OUT: OUTPUT TO CALCOMP PLOTTER
!     IF(ITRIG.EQ.3) CALL LINE(XC,YC,22,1,0,4)
      IF(ITRIG==1) GO TO 9
C...PLOT OF BLADE STACKED ON CG
      IF(ITRIG/=4) GO TO 24
      DO 25 I=1,50
      XS(I)=XS(I)-XCG
      XP(I)=XP(I)-XCG
      YS(I)=YS(I)-YCG
      YP(I)=YP(I)-YCG
   25 CONTINUE
!   VER. 2022
!   COMMENTED OUT: OUTPUT TO CALCOMP PLOTTER
!     IF(ICG.EQ.0) CALL PLOT(3.25,5.,-3)
!     IF(ICG.EQ.0) CALL SYMBOL(0.,0.,.07,3,0.,-1)
      ICG=1
!   VER. 2022
!   COMMENTED OUT: OUTPUT TO CALCOMP PLOTTER
!     CALL LINE(XS,YS,50,1,0,4)
!     CALL LINE(XP,YP,50,1,0,4)
      GO TO 1
C...PLOT OF THE AIRFOIL ONE PITCH AWAY
   24 CONTINUE
!   VER. 2022
!   COMMENTED OUT: OUTPUT TO CALCOMP PLOTTER
!  24 CALL SYMBOL (X2*FACTOR,Y2*FACTOR,.07,3,0.,-1)
      DO 10 I=1,50
      YP(I)=YP(I)+PITCH
      YS(I)=YS(I)+PITCH
   10 CONTINUE
!   VER. 2022
!   COMMENTED OUT: OUTPUT TO CALCOMP PLOTTER
!     CALL LINE(XS,YS,50,1,0,4)
!     CALL LINE(XP,YP,50,1,0,4)
    9 CONTINUE
!   VER. 2022
!   COMMENTED OUT: OUTPUT TO CALCOMP PLOTTER
!   9 CALL TITLES(TITLE,R,CX,CT,THROAT,UGT,BIN,WEDGIN,RLE,BOUT,RTE,NB
!    +,AREA,PITCH,STAG,FACTOR,TMAX,CHORD,ZWEIFEL,SOL,XCG,YCG,PCTI,PCTE
!    +,WEDGOUT,THETAC,CL)
!
!     CALL PLOT(8.5,0.,-3)
    1 CONTINUE
!   VER. 2022
!   COMMENTED OUT: OUTPUT TO CALCOMP PLOTTER
!     IF(ITRIG.EQ.4) CALL PLOT(-3.25,0.,-3)
!     CALL PLOT(7.5,0,999)
!
!   VER. 2022
      CLOSE (25, STATUS = 'KEEP')
      CLOSE (16, STATUS = 'KEEP')
!
      END
C
      SUBROUTINE CUBIC(X2,Y2,BETA2,X3,Y3,BETA3,A,B,C,D)
C...THIS SUBROUTINE PUTS A CUBIC THROUGH TWO POINTS WITH TWO SLOPES, AND
C...SOLVES FOR THE COEFFICIENTS OF Y=A+BX+CX**2+DX**3
      PI=3.14159
      D=(TAN(BETA2*PI/180.)+TAN(BETA3*PI/180.))/(X3-X2)/(X3-X2)
     +-2.*(Y2-Y3)/(X2-X3)/(X2-X3)/(X2-X3)
      C=(Y2-Y3)/(X2-X3)/(X2-X3)-TAN(BETA3*PI/180.)/(X2-X3)-D*(X2+2.*X3)
      B=TAN(BETA3*PI/180.)-2.*C*X3-3.*D*X3*X3
      A=Y3-B*X3-C*X3*X3-D*X3*X3*X3
      RETURN
      END
C
!   VER. 2022
!   COMMENTED OUT: CALCOMP PLOTTER RELATED CODE
!       SUBROUTINE TITLES(TITLE,R,CX,CT,THROAT,UGT,BIN,WEDGIN,RLE,BOUT,RTE
!      +,NB,AREA*PITCH,STAG,FACTOR,TMAX,CHORD,ZWEIFEL,SOL,XCG,YCG,PCTI
!      +,PCTE,WEDGOUT,THETAC,CL)
! C...THIS SUBROUTINE LABELS AND PUTS LEGEND ON THE PLOT
!       REAL NB
!       INTEGER*3 DA(3),TI(3)
!       CALL SYMBOL(0.,10.,.14,TITLE,0.,54)
!       CALL SYMBOL(6.0,9.5,.07,2HR=,0.,2)
!   END PAGE 10 OF PDF FILE, ARTICLE CODE IS 85-GT-219
!       CALL NUMBER(999. ,999.,.07,R,0.,31
!       CALL SYMBOL(G.Q,9.4,.07,3HCX=o0.,31
!       CALL NUHBER(399** 9 39.,.0 1, c x, o .,31
!       CALL SYMBOL(6.0,9.3,.07,3HCT=,O.,JJ
!       CALL NUMBER(999 . ,999***01.cr,o * * 3J
!       CALL SYMBOL(6.0,9.2,.07,�HUGT:,Q, ,4J
!       CALL NUMBER(999,,999.,. 01.uGT , a **21
!       CALL SYMBOL(6.o,9.t,.07,8HBETA TN=,o.,8)
!       CALL NUMBER(9 99**999*** 01,srN.o ** 11
!       CALL SYMBOL(6.0,9.o,.01.t4HHALF WEDGE IN=.a * * 1�1
!       CALL NUMBER(999.,999.,.o7,wEDGfNt0.,21
!       CALL SYMBOL(6.0,8 .9,. 0 7.4H RLE=,o.,4J
!       CALL NUHBER( 999**999** * c1,RLE,o **41
!       CALL SYMBOL(6.0,B.A ** 07 ,9HBETA OUT=,0.,91
!       CALL NUMBER( 999.,999***01.aour,o** 1)
!       CALL SYMBOL(G.o,a.1,.01,4HRTE=,0.,4)
!       CALL NUHBE R!999 .,9 9 9 .,, Q7,R TE ** 0,41
!       CALL SYMBOL(6.0,B.6,.07,JHNB= *O*t31
!       CALL NUMBER( 9 99**999***o7.NB.o.,-11
!       CALL SYMBOL(6.0,B.s **0 1 ,7HT H R OAT= ,o., 1 1
!       CALL NUHBER1999,,999,,.07,THROAT,0.,3l
!       CALL SYMBOL( ( G.o ,s .3,.0 1,6HP ITCH= .o**6)
!       CALL NUMBER( 9 99 .,9 9 9.,.o7 ,PT TCH . o** 31
!       CALL SYMBOL( 6 .o, s. 2,.01,1sHHALF WF�r.r �ur=.o.,t5)
!       CALL NUMBER(999.,999.,.01.wEDGOUT,o.,2)
!       CALL SYMBOL(G.o.s.1 **0 1.B HSTAGGER=.o**e1
!       CALL NUHBE R( 9 9 9** 999***01,srAG,o** 11
!       CALL SY HB OL ! G . 0,8 .0,.07,S HAR EA=,o** s)
!       CALL NUHB ER( 9 99.,9 9 9., .0 7,ARTA,0 0 ,*l
!       CALL SY HB OL(G. o,7.9 , . 07.SHTHA X=.o ** 5)
!       CALL NUHBE R( 999.,99 9 *** 01 ,TMAx.o .,41
!       CALL SYMBOL( ( 6. o, 1 .s ,. 0 1,6HCHO RO=,o** 6J
!       CALL NUMBER(999.,999.,.01,CHOR0,o.,3)
!       CALL ST"80L(6.o.1.1,.01,sHZWETFEL=·o ** s1
!       CALL NUMBER(999,,999***01. zwET FEL t0. , 3)
!       CALL SYMBOL(G.o,1.G,.01,9HSOLTDTTY=,o**91
!       CALL NUMBER(999,,999***01, soL, 0 ., 31
!       CALL SYMBOL(G.o,1.s** 01.4HXCG= .o ** 4)
!       CALL NUMBER(999 . ,99 9 .,.01. xcG .o., 3 J
!       CALL STHBOLC6.0,7.4,.07,4HYC6=*0**41
!       CALL NUMBERC999 .,9 99,,.o7,TCG,o.,31
!       CALL SYMBOL(6.0,7.3,.07,12HlttLET BLDCK:,Q,,121
!       CALL NUHBER(999.,99g.,.07oPCTT,0.,2)
!       CALL SYMBOL(G.o,1.2,.01.11HEX1T BlOCK=·o ** 11 1
!       CALL NUHBERC999.,9990,.Q7,PCTEtOot2l
!       CALL SYHBOL ( 6 . 0t7*1,. 0 7 ,13HCAH BER ANGLE:,0,,13!
!       CALL NUMBER( 999,,99 9 * * *01,THETAC,o.,1)
!       CALL STMBOLC 6.0,7. 0 ,.0 7o llHL lFT COEFF=,0** 111
!       CALL NUMBER(999.,999.,.01.cL,.o.21
!       CALL NUHBERCG.O,G.9,.07,FACTOR,0.,-1)
!       CALL SYH80L C 9 99.,99 9. ,.07 , 6HX STZE,0.,6)
!       CALL DATECOA)
!       CALL TlHEITI)
!       CALL SYMBOL(5.93,6.7,,07,TI,Oot9l
!       CALL STHBOL l6.0o6.6,.01.0A,o.,9)
!       RETURN
!       END
C
      SUBROUTINE MECPRO(XS,YS,XP,YP,AREA,XCG,YCG)
C...SUBROUTINE TO COMPUTE CROSSECTIONAl AREA AND CENTER-OF-GRAVITY
C...BY BREAKING AIRFOIL UP INTO TRIANGLES
      DIMENSION XS(50),YS(50),XP(50),YP(50)
      A(X1,Y1,X2,Y2,X3,Y3)=ABS(X1*Y2+Y1*X3+Y3*X2-Y2*X3-Y1*X2-X1*Y3)/2.
      AREA=A(XS(1),YS(1),XS(2),YS(2),XP(2),YP(2))
      XCG=(XS(1)+XS(2)+XP(2))/3.*AREA
      YCG=(YS(1)+YS(2)+YP(2))/3.*AREA
      DO 1 I=2,48
      A1=A(XS(I),YS(I),XS(I+1),YS(I+1),XP(I),YP(I))
      AREA=AREA+A1
      XCG=XCG+(XS(I)+XS(I+1)+XP(I))/3.*A1
      YCG=YCG+(YS(I)+YS(I+1)+YP(I))/3.*A1
      A2=A(XS(I),YS(I),XP(I),YP(I),XP(I+1),YP(I+1))
      AREA=AREA+A2
      XCG=XCG+(XS(I)+XP(I)+XP(I+1))/3.*A2
      YCG=YCG+(YS(I)+YP(I)+YP(I+1))/3.*A2
    1 CONTINUE
      A1=A(XS(49),YS(49),XS(50),YS(50),XP(49),YP(49))
      AREA=AREA+A1
      XCG=XCG+(XS(49)+XS(50)+XP(49))/3.*A1
      YCG=YCG+(YS(49)+YS(50)+YP(49))/3.*A1
      XCG=XCG/AREA
      YCG=YCG/AREA
      RETURN
      END
